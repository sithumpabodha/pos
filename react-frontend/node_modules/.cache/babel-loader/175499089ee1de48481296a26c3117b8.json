{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Route,useLocation,Navigate,Routes}from\"react-router-dom\";//import \"../../pos/src/assets/sass/style.react.scss\";\nimport{useDispatch,useSelector}from\"react-redux\";import{IntlProvider}from\"react-intl\";import{settingsKey,Tokens}from\"./constants\";import Toasts from\"./shared/toast/Toasts\";import{fetchFrontSetting}from\"./store/action/frontSettingAction\";import{fetchConfig}from\"./store/action/configAction\";import{addRTLSupport}from\"./shared/sharedMethod\";import Login from\"./components/auth/Login\";import ResetPassword from\"./components/auth/ResetPassword\";import ForgotPassword from\"./components/auth/ForgotPassword\";import AdminApp from\"./AdminApp\";import{getFiles}from\"./locales/index\";import'./assets/sass/style.react.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){//do not remove updateLanguag\nconst dispatch=useDispatch();const{updateLanguage}=useSelector(state=>state);const location=useLocation();const token=localStorage.getItem(Tokens.ADMIN);const updatedLanguage=localStorage.getItem(Tokens.UPDATED_LANGUAGE);const{selectedLanguage,config,language}=useSelector(state=>state);const[allLocales,setAllLocales]=useState({});const[messages,setMessages]=useState({});const[userEditedMessage,setUserEditedMessage]=useState({});const updateLanguag=allLocales[updatedLanguage?updatedLanguage:selectedLanguage];const[languageData,setLanguageData]=useState([]);const mapPermissionToRoute=permission=>{const entity=permission.split('_')[1];return`/app/${entity}`;};const[mappedRoutes,setMappedRoutes]=useState([]);const[redirectTo,setRedirectTo]=useState('');useEffect(()=>{setMappedRoutes(config.map(mapPermissionToRoute));},[config]);useEffect(()=>{if(mappedRoutes&&mappedRoutes.length>0){if(config.includes('manage_dashboard')){setRedirectTo('/app/dashboard');}else{setRedirectTo(mappedRoutes[0]);;}}else{setRedirectTo('/app/dashboard');}},[mappedRoutes]);useEffect(()=>{const getData=getFiles();setAllLocales(getData);},[language,updateLanguage===null||updateLanguage===void 0?void 0:updateLanguage.lang_json_array]);useEffect(()=>{if((updateLanguage===null||updateLanguage===void 0?void 0:updateLanguage.iso_code)===updatedLanguage&&languageData){setUserEditedMessage(updateLanguage===null||updateLanguage===void 0?void 0:updateLanguage.lang_json_array);}},[language,languageData]);// updated language hendling\nuseEffect(()=>{if(Object.values(userEditedMessage).length!==0){setMessages(userEditedMessage);}else{if((updateLanguage===null||updateLanguage===void 0?void 0:updateLanguage.iso_code)===updatedLanguage){const updateLanguages=updateLanguage===null||updateLanguage===void 0?void 0:updateLanguage.lang_json_array;setMessages(updateLanguages);}else{if(updateLanguag===undefined||updateLanguag===null||updateLanguag===\"\"){const defaultUpdateLanguage=allLocales[\"en\"];setMessages(defaultUpdateLanguage);}else{if(updateLanguag===undefined||updateLanguag===null){const defaultUpdateLanguage=allLocales[\"en\"];setMessages(defaultUpdateLanguage);}else{setMessages(updateLanguag);}}}}},[allLocales,updateLanguage===null||updateLanguage===void 0?void 0:updateLanguage.lang_json_array]);useEffect(()=>{selectCSS();},[location.pathname]);useEffect(()=>{if(token){dispatch(fetchConfig());dispatch(fetchFrontSetting());}},[]);const selectCSS=()=>{if(updatedLanguage===\"ar\"){require(\"./assets/css/custom.rtl.css\");require(\"./assets/css/style.rtl.css\");require(\"./assets/css/frontend.rtl.css\");}else{require(\"./assets/css/custom.css\");require(\"./assets/css/style.css\");require(\"./assets/css/frontend.css\");}};useEffect(()=>{addRTLSupport(updatedLanguage?updatedLanguage:selectedLanguage);},[updatedLanguage,selectedLanguage]);return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column flex-root\",children:/*#__PURE__*/_jsxs(IntlProvider,{locale:settingsKey.DEFAULT_LOCALE,messages:messages,children:[/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"reset-password/:token/:email\",element:/*#__PURE__*/_jsx(ResetPassword,{})}),/*#__PURE__*/_jsx(Route,{path:\"forgot-password\",element:/*#__PURE__*/_jsx(ForgotPassword,{})}),/*#__PURE__*/_jsx(Route,{path:\"app/*\",element:/*#__PURE__*/_jsx(AdminApp,{config:config})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Navigate,{replace:true,to:token?redirectTo:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{replace:true,to:\"/\"})})]}),/*#__PURE__*/_jsx(Toasts,{language:updatedLanguage?updatedLanguage:selectedLanguage})]})});}export default App;","map":{"version":3,"names":["React","useEffect","useState","Route","useLocation","Navigate","Routes","useDispatch","useSelector","IntlProvider","settingsKey","Tokens","Toasts","fetchFrontSetting","fetchConfig","addRTLSupport","Login","ResetPassword","ForgotPassword","AdminApp","getFiles","jsx","_jsx","jsxs","_jsxs","App","dispatch","updateLanguage","state","location","token","localStorage","getItem","ADMIN","updatedLanguage","UPDATED_LANGUAGE","selectedLanguage","config","language","allLocales","setAllLocales","messages","setMessages","userEditedMessage","setUserEditedMessage","updateLanguag","languageData","setLanguageData","mapPermissionToRoute","permission","entity","split","mappedRoutes","setMappedRoutes","redirectTo","setRedirectTo","map","length","includes","getData","lang_json_array","iso_code","Object","values","updateLanguages","undefined","defaultUpdateLanguage","selectCSS","pathname","require","className","children","locale","DEFAULT_LOCALE","path","element","replace","to"],"sources":["C:/Users/Sithu/Music/react-frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Route, useLocation, Navigate, Routes } from \"react-router-dom\";\n//import \"../../pos/src/assets/sass/style.react.scss\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { IntlProvider } from \"react-intl\";\nimport { settingsKey, Tokens } from \"./constants\";\nimport Toasts from \"./shared/toast/Toasts\";\nimport { fetchFrontSetting } from \"./store/action/frontSettingAction\";\nimport { fetchConfig } from \"./store/action/configAction\";\nimport { addRTLSupport } from \"./shared/sharedMethod\";\nimport Login from \"./components/auth/Login\";\nimport ResetPassword from \"./components/auth/ResetPassword\";\nimport ForgotPassword from \"./components/auth/ForgotPassword\";\nimport AdminApp from \"./AdminApp\";\nimport { getFiles } from \"./locales/index\";\nimport './assets/sass/style.react.scss';\n\nfunction App() {\n    //do not remove updateLanguag\n    const dispatch = useDispatch();\n    const { updateLanguage } = useSelector((state) => state);\n    const location = useLocation();\n    const token = localStorage.getItem(Tokens.ADMIN);\n    const updatedLanguage = localStorage.getItem(Tokens.UPDATED_LANGUAGE);\n    const { selectedLanguage, config, language } = useSelector(\n        (state) => state\n    );\n    const [allLocales, setAllLocales] = useState({});\n    const [messages, setMessages] = useState({});\n    const [userEditedMessage, setUserEditedMessage] = useState({});\n    const updateLanguag =\n        allLocales[updatedLanguage ? updatedLanguage : selectedLanguage];\n    const [languageData, setLanguageData] = useState([]);\n\n    const mapPermissionToRoute = (permission) => {\n        const entity = permission.split('_')[1];\n        return `/app/${entity}`;\n    };\n\n    const [mappedRoutes, setMappedRoutes] = useState([]);\n    const [redirectTo, setRedirectTo] = useState('');\n    useEffect(() => {\n        setMappedRoutes(config.map(mapPermissionToRoute));\n    }, [config]);\n\n    useEffect(() => {\n        if (mappedRoutes && mappedRoutes.length > 0) {\n            if (config.includes('manage_dashboard')) {\n                setRedirectTo('/app/dashboard');\n            } else {\n                setRedirectTo(mappedRoutes[0]);;\n            }\n        } else {\n            setRedirectTo('/app/dashboard');\n        }\n    }, [mappedRoutes]);\n\n    useEffect(() => {\n        const getData = getFiles();\n        setAllLocales(getData);\n    }, [language, updateLanguage?.lang_json_array]);\n\n    useEffect(() => {\n        if (updateLanguage?.iso_code === updatedLanguage && languageData) {\n            setUserEditedMessage(updateLanguage?.lang_json_array);\n        }\n    }, [language, languageData]);\n\n    // updated language hendling\n    useEffect(() => {\n        if (Object.values(userEditedMessage).length !== 0) {\n            setMessages(userEditedMessage);\n        } else {\n            if (updateLanguage?.iso_code === updatedLanguage) {\n                const updateLanguages = updateLanguage?.lang_json_array;\n                setMessages(updateLanguages);\n            } else {\n                if (\n                    updateLanguag === undefined ||\n                    updateLanguag === null ||\n                    updateLanguag === \"\"\n                ) {\n                    const defaultUpdateLanguage = allLocales[\"en\"];\n                    setMessages(defaultUpdateLanguage);\n                } else {\n                    if (updateLanguag === undefined || updateLanguag === null) {\n                        const defaultUpdateLanguage = allLocales[\"en\"];\n                        setMessages(defaultUpdateLanguage);\n                    } else {\n                        setMessages(updateLanguag);\n                    }\n                }\n            }\n        }\n    }, [allLocales, updateLanguage?.lang_json_array]);\n\n    useEffect(() => {\n        selectCSS();\n    }, [location.pathname]);\n\n    useEffect(() => {\n        if (token) {\n            dispatch(fetchConfig());\n            dispatch(fetchFrontSetting());\n        }\n    }, []);\n\n    const selectCSS = () => {\n        if (updatedLanguage === \"ar\") {\n            require(\"./assets/css/custom.rtl.css\");\n            require(\"./assets/css/style.rtl.css\");\n            require(\"./assets/css/frontend.rtl.css\");\n        } else {\n            require(\"./assets/css/custom.css\");\n            require(\"./assets/css/style.css\");\n            require(\"./assets/css/frontend.css\");\n        }\n    };\n\n    useEffect(() => {\n        addRTLSupport(updatedLanguage ? updatedLanguage : selectedLanguage);\n    }, [updatedLanguage, selectedLanguage]);\n\n    return (\n        <div className=\"d-flex flex-column flex-root\">\n            <IntlProvider\n                locale={settingsKey.DEFAULT_LOCALE}\n                messages={messages}\n            >\n                <Routes>\n                    <Route path=\"/login\" element={<Login />} />\n                    <Route\n                        path=\"reset-password/:token/:email\"\n                        element={<ResetPassword />}\n                    />\n                    <Route\n                        path=\"forgot-password\"\n                        element={<ForgotPassword />}\n                    />\n                    <Route\n                        path=\"app/*\"\n                        element={<AdminApp config={config} />}\n                    />\n                    <Route\n                        path=\"/\"\n                        element={\n                            <Navigate\n                                replace\n                                to={token ? redirectTo : \"/login\"}\n                            />\n                        }\n                    />\n                    <Route path=\"*\" element={<Navigate replace to={\"/\"} />} />\n                </Routes>\n                <Toasts\n                    language={\n                        updatedLanguage ? updatedLanguage : selectedLanguage\n                    }\n                />\n            </IntlProvider>\n        </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}