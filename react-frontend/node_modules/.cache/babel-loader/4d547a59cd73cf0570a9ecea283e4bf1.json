{"ast":null,"code":"import React,{useEffect}from'react';import{connect}from'react-redux';import{fetchAllWarehouses}from'../../store/action/warehouseAction';import{useParams}from'react-router-dom';import HeaderTitle from'../header/HeaderTitle';import MasterLayout from'../MasterLayout';import PurchaseForm from'./PurchaseForm';import{fetchAllSuppliers}from'../../store/action/supplierAction';import{fetchPurchase}from'../../store/action/purchaseAction';import{editPrepareArray}from'../../shared/prepareArray/editPrepareArray';import{getFormattedMessage,getFormattedOptions}from'../../shared/sharedMethod';import Spinner from\"../../shared/components/loaders/Spinner\";import TopProgressBar from\"../../shared/components/loaders/TopProgressBar\";import{purchaseStatusOptions}from'../../constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const EditPurchase=props=>{const{fetchPurchase,purchases,warehouses,fetchAllSuppliers,suppliers,fetchAllWarehouses,isLoading}=props;const{id}=useParams();useEffect(()=>{fetchAllWarehouses();fetchAllSuppliers();fetchPurchase(id);},[]);const supplierId=purchases&&purchases.attributes&&purchases.attributes.supplier_id;const warehouseId=purchases&&purchases.attributes&&purchases.attributes.warehouse_id;const supplier=suppliers&&suppliers.filter(supplier=>supplier.id===supplierId);const supplierName=supplier[0]&&supplier[0].attributes&&supplier[0].attributes.name;const warehouse=warehouses.filter(warehouse=>warehouse.id===warehouseId);const warehouseName=warehouse[0]&&warehouse[0].attributes&&warehouse[0].attributes.name;purchases&&purchases.attributes&&purchases.attributes.purchase_items.forEach(item=>{item.fix_net_unit=item.product_cost;item.stock_alert=item.product&&item.product.stock_alert;item.short_name=item.purchase_unit.short_name;item.newItem='';item.purchase_item_id=item.id;item.code=item.product&&item.product.code;item.name=item.product&&item.product.name;});const statusFilterOptions=getFormattedOptions(purchaseStatusOptions);const statusDefaultValue=purchases.attributes&&purchases.attributes.status&&statusFilterOptions.filter(item=>item.id===purchases.attributes.status);const purchasesItemsId=purchases&&purchases.attributes&&purchases.attributes.purchase_items&&purchases.attributes.purchase_items.map(item=>item.id);const itemsValue=purchases&&purchases.attributes&&{date:purchases.attributes.date,warehouse_id:{value:purchases.attributes.warehouse_id,label:warehouseName},supplier_id:{value:purchases.attributes.supplier_id,label:supplierName},discount:purchases.attributes.discount,tax_rate:purchases.attributes.tax_rate,shipping:purchases.attributes.shipping,notes:purchases.attributes.notes,purchase_items:editPrepareArray(purchases.attributes.purchase_items,purchases.attributes.warehouse_id),newItem:'',purchase_item_id:purchasesItemsId?purchasesItemsId[0]:'',id:purchases.id,status_id:{label:statusDefaultValue[0]&&statusDefaultValue[0].name,value:statusDefaultValue[0]&&statusDefaultValue[0].id},tax_amount:purchases.attributes.tax_amount};return/*#__PURE__*/_jsxs(MasterLayout,{children:[/*#__PURE__*/_jsx(TopProgressBar,{}),/*#__PURE__*/_jsx(HeaderTitle,{title:getFormattedMessage('purchase.edit.title'),to:\"/app/purchases\"}),isLoading?/*#__PURE__*/_jsx(Spinner,{}):/*#__PURE__*/_jsx(PurchaseForm,{singlePurchase:itemsValue,id:id,warehouses:warehouses,suppliers:suppliers})]});};const mapStateToProps=state=>{const{purchases,warehouses,suppliers,isLoading}=state;return{purchases,warehouses,suppliers,isLoading};};export default connect(mapStateToProps,{fetchPurchase,fetchAllSuppliers,fetchAllWarehouses})(EditPurchase);","map":{"version":3,"names":["React","useEffect","connect","fetchAllWarehouses","useParams","HeaderTitle","MasterLayout","PurchaseForm","fetchAllSuppliers","fetchPurchase","editPrepareArray","getFormattedMessage","getFormattedOptions","Spinner","TopProgressBar","purchaseStatusOptions","jsx","_jsx","jsxs","_jsxs","EditPurchase","props","purchases","warehouses","suppliers","isLoading","id","supplierId","attributes","supplier_id","warehouseId","warehouse_id","supplier","filter","supplierName","name","warehouse","warehouseName","purchase_items","forEach","item","fix_net_unit","product_cost","stock_alert","product","short_name","purchase_unit","newItem","purchase_item_id","code","statusFilterOptions","statusDefaultValue","status","purchasesItemsId","map","itemsValue","date","value","label","discount","tax_rate","shipping","notes","status_id","tax_amount","children","title","to","singlePurchase","mapStateToProps","state"],"sources":["C:/Users/Sithu/Music/react-frontend/src/components/purchase/EditPurchase.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { fetchAllWarehouses } from '../../store/action/warehouseAction';\nimport { useParams } from 'react-router-dom'\nimport HeaderTitle from '../header/HeaderTitle';\nimport MasterLayout from '../MasterLayout';\nimport PurchaseForm from './PurchaseForm';\nimport { fetchAllSuppliers } from '../../store/action/supplierAction';\nimport { fetchPurchase } from '../../store/action/purchaseAction';\nimport { editPrepareArray } from '../../shared/prepareArray/editPrepareArray';\nimport { getFormattedMessage, getFormattedOptions } from '../../shared/sharedMethod';\nimport Spinner from \"../../shared/components/loaders/Spinner\";\nimport TopProgressBar from \"../../shared/components/loaders/TopProgressBar\";\nimport { purchaseStatusOptions } from '../../constants';\n\nconst EditPurchase = ( props ) => {\n    const { fetchPurchase, purchases, warehouses, fetchAllSuppliers, suppliers, fetchAllWarehouses, isLoading } = props;\n    const { id } = useParams();\n\n    useEffect( () => {\n        fetchAllWarehouses();\n        fetchAllSuppliers();\n        fetchPurchase( id );\n    }, [] );\n\n    const supplierId = purchases && purchases.attributes && purchases.attributes.supplier_id\n    const warehouseId = purchases && purchases.attributes && purchases.attributes.warehouse_id\n    const supplier = suppliers && suppliers.filter( ( supplier ) => supplier.id === supplierId );\n    const supplierName = supplier[ 0 ] && supplier[ 0 ].attributes && supplier[ 0 ].attributes.name\n    const warehouse = warehouses.filter( ( warehouse ) => warehouse.id === warehouseId );\n    const warehouseName = warehouse[ 0 ] && warehouse[ 0 ].attributes && warehouse[ 0 ].attributes.name\n    purchases && purchases.attributes && purchases.attributes.purchase_items.forEach( ( item ) => {\n        item.fix_net_unit = item.product_cost\n        item.stock_alert = item.product && item.product.stock_alert\n        item.short_name = item.purchase_unit.short_name\n        item.newItem = ''\n        item.purchase_item_id = item.id\n        item.code = item.product && item.product.code\n        item.name = item.product && item.product.name\n    } );\n\n    const statusFilterOptions = getFormattedOptions( purchaseStatusOptions )\n    const statusDefaultValue = purchases.attributes && purchases.attributes.status && statusFilterOptions.filter( ( item ) => item.id === purchases.attributes.status )\n\n    const purchasesItemsId = purchases && purchases.attributes && purchases.attributes.purchase_items && purchases.attributes.purchase_items.map( ( item ) => item.id )\n\n    const itemsValue = purchases && purchases.attributes && {\n        date: purchases.attributes.date,\n        warehouse_id: {\n            value: purchases.attributes.warehouse_id,\n            label: warehouseName,\n        },\n        supplier_id: {\n            value: purchases.attributes.supplier_id,\n            label: supplierName,\n        },\n        discount: purchases.attributes.discount,\n        tax_rate: purchases.attributes.tax_rate,\n        shipping: purchases.attributes.shipping,\n        notes: purchases.attributes.notes,\n        purchase_items: editPrepareArray( purchases.attributes.purchase_items, purchases.attributes.warehouse_id ),\n        newItem: '',\n        purchase_item_id: purchasesItemsId ? purchasesItemsId[ 0 ] : '',\n        id: purchases.id,\n        status_id: {\n            label: statusDefaultValue[ 0 ] && statusDefaultValue[ 0 ].name,\n            value: statusDefaultValue[ 0 ] && statusDefaultValue[ 0 ].id\n        },\n        tax_amount: purchases.attributes.tax_amount,\n    };\n\n    return (\n        <MasterLayout>\n            <TopProgressBar />\n            <HeaderTitle title={getFormattedMessage( 'purchase.edit.title' )} to='/app/purchases' />\n            {isLoading ? <Spinner /> :\n                <PurchaseForm singlePurchase={itemsValue} id={id} warehouses={warehouses} suppliers={suppliers} />}\n        </MasterLayout>\n    )\n};\n\nconst mapStateToProps = ( state ) => {\n    const { purchases, warehouses, suppliers, isLoading } = state;\n    return { purchases, warehouses, suppliers, isLoading }\n};\n\nexport default connect( mapStateToProps, { fetchPurchase, fetchAllSuppliers, fetchAllWarehouses } )( EditPurchase );\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}