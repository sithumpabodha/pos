{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import AsideDefault from\"./sidebar/asideDefault\";import Header from\"./header/Header\";import Footer from\"./footer/Footer\";import AsideTopSubMenuItem from\"./sidebar/asideTopSubMenuItem\";import{Tokens}from\"../constants\";import asideConfig from\"../config/asideConfig\";import{environment}from\"../config/environment\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faBars}from\"@fortawesome/free-solid-svg-icons\";import{fetchConfig}from\"../store/action/configAction\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const MasterLayout=props=>{const{children,newPermissions,frontSetting,fetchConfig,config,allConfigData}=props;const[isResponsiveMenu,setIsResponsiveMenu]=useState(false);const[isMenuCollapse,setIsMenuCollapse]=useState(false);const newRoutes=config&&prepareRoutes(config);const token=localStorage.getItem(Tokens.ADMIN);useEffect(()=>{if(token){fetchConfig();}if(!token){window.location.href=environment.URL+\"#\"+\"/login\";}},[]);const menuClick=()=>{setIsResponsiveMenu(!isResponsiveMenu);};const menuIconClick=()=>{setIsMenuCollapse(!isMenuCollapse);};return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row flex-column-fluid\",children:[/*#__PURE__*/_jsx(AsideDefault,{asideConfig:newRoutes,frontSetting:frontSetting,isResponsiveMenu:isResponsiveMenu,menuClick:menuClick,menuIconClick:menuIconClick,isMenuCollapse:isMenuCollapse}),/*#__PURE__*/_jsxs(\"div\",{className:`${isMenuCollapse===true?\"wrapper-res\":\"wrapper\"} d-flex flex-column flex-row-fluid`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-stretch justify-content-between header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid d-flex align-items-stretch justify-content-xxl-between flex-grow-1\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn d-flex align-items-center d-xl-none px-0\",title:\"Show aside menu\",onClick:menuClick,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBars,className:\"fs-1\"})}),/*#__PURE__*/_jsx(AsideTopSubMenuItem,{asideConfig:asideConfig,isMenuCollapse:isMenuCollapse}),/*#__PURE__*/_jsx(Header,{newRoutes:newRoutes})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"content d-flex flex-column flex-column-fluid pt-7\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column-fluid\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:children})})}),/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsx(Footer,{allConfigData:allConfigData,frontSetting:frontSetting})})]})]});};const getRouteWithSubMenu=(route,permissions)=>{const subRoutes=route.subMenu?route.subMenu.filter(item=>permissions.indexOf(item.permission)!==-1||item.permission===\"\"):null;const newSubRoutes=subRoutes?{...route,newRoute:subRoutes}:route;return newSubRoutes;};const prepareRoutes=config=>{const permissions=config;let filterRoutes=[];asideConfig.forEach(route=>{var _permissionsRoute$new;const permissionsRoute=getRouteWithSubMenu(route,permissions);if(permissions&&permissions.indexOf(route.permission)!==-1||route.permission===\"\"||(_permissionsRoute$new=permissionsRoute.newRoute)!==null&&_permissionsRoute$new!==void 0&&_permissionsRoute$new.length){filterRoutes.push(permissionsRoute);}});return filterRoutes;};const mapStateToProps=state=>{const newPermissions=[];const{permissions,settings,frontSetting,config,allConfigData}=state;if(permissions){permissions.forEach(permission=>newPermissions.push(permission.attributes.name));}return{newPermissions,settings,frontSetting,config,allConfigData};};export default connect(mapStateToProps,{fetchConfig})(MasterLayout);","map":{"version":3,"names":["React","useEffect","useState","connect","AsideDefault","Header","Footer","AsideTopSubMenuItem","Tokens","asideConfig","environment","FontAwesomeIcon","faBars","fetchConfig","jsx","_jsx","jsxs","_jsxs","MasterLayout","props","children","newPermissions","frontSetting","config","allConfigData","isResponsiveMenu","setIsResponsiveMenu","isMenuCollapse","setIsMenuCollapse","newRoutes","prepareRoutes","token","localStorage","getItem","ADMIN","window","location","href","URL","menuClick","menuIconClick","className","type","title","onClick","icon","getRouteWithSubMenu","route","permissions","subRoutes","subMenu","filter","item","indexOf","permission","newSubRoutes","newRoute","filterRoutes","forEach","_permissionsRoute$new","permissionsRoute","length","push","mapStateToProps","state","settings","attributes","name"],"sources":["C:/Users/Sithu/Music/react-frontend/src/components/MasterLayout.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport AsideDefault from \"./sidebar/asideDefault\";\nimport Header from \"./header/Header\";\nimport Footer from \"./footer/Footer\";\nimport AsideTopSubMenuItem from \"./sidebar/asideTopSubMenuItem\";\nimport { Tokens } from \"../constants\";\nimport asideConfig from \"../config/asideConfig\";\nimport { environment } from \"../config/environment\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faBars } from \"@fortawesome/free-solid-svg-icons\";\nimport { fetchConfig } from \"../store/action/configAction\";\n\nconst MasterLayout = (props) => {\n    const {\n        children,\n        newPermissions,\n        frontSetting,\n        fetchConfig,\n        config,\n        allConfigData,\n    } = props;\n    const [isResponsiveMenu, setIsResponsiveMenu] = useState(false);\n    const [isMenuCollapse, setIsMenuCollapse] = useState(false);\n    const newRoutes = config && prepareRoutes(config);\n    const token = localStorage.getItem(Tokens.ADMIN);\n\n    useEffect(() => {\n        if (token) {\n            fetchConfig();\n        }\n        if (!token) {\n            window.location.href = environment.URL + \"#\" + \"/login\";\n        }\n    }, []);\n\n    const menuClick = () => {\n        setIsResponsiveMenu(!isResponsiveMenu);\n    };\n\n    const menuIconClick = () => {\n        setIsMenuCollapse(!isMenuCollapse);\n    };\n\n    return (\n        <div className=\"d-flex flex-row flex-column-fluid\">\n            <AsideDefault\n                asideConfig={newRoutes}\n                frontSetting={frontSetting}\n                isResponsiveMenu={isResponsiveMenu}\n                menuClick={menuClick}\n                menuIconClick={menuIconClick}\n                isMenuCollapse={isMenuCollapse}\n            />\n            <div\n                className={`${\n                    isMenuCollapse === true ? \"wrapper-res\" : \"wrapper\"\n                } d-flex flex-column flex-row-fluid`}\n            >\n                <div className=\"d-flex align-items-stretch justify-content-between header\">\n                    <div className=\"container-fluid d-flex align-items-stretch justify-content-xxl-between flex-grow-1\">\n                        <button\n                            type=\"button\"\n                            className=\"btn d-flex align-items-center d-xl-none px-0\"\n                            title=\"Show aside menu\"\n                            onClick={menuClick}\n                        >\n                            <FontAwesomeIcon icon={faBars} className=\"fs-1\" />\n                        </button>\n                        <AsideTopSubMenuItem\n                            asideConfig={asideConfig}\n                            isMenuCollapse={isMenuCollapse}\n                        />\n                        <Header newRoutes={newRoutes} />\n                    </div>\n                </div>\n                <div className=\"content d-flex flex-column flex-column-fluid pt-7\">\n                    <div className=\"d-flex flex-column-fluid\">\n                        <div className=\"container-fluid\">{children}</div>\n                    </div>\n                </div>\n                <div className=\"container-fluid\">\n                    <Footer\n                        allConfigData={allConfigData}\n                        frontSetting={frontSetting}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nconst getRouteWithSubMenu = (route, permissions) => {\n    const subRoutes = route.subMenu\n        ? route.subMenu.filter(\n              (item) =>\n                  permissions.indexOf(item.permission) !== -1 ||\n                  item.permission === \"\"\n          )\n        : null;\n    const newSubRoutes = subRoutes ? { ...route, newRoute: subRoutes } : route;\n    return newSubRoutes;\n};\n\nconst prepareRoutes = (config) => {\n    const permissions = config;\n    let filterRoutes = [];\n    asideConfig.forEach((route) => {\n        const permissionsRoute = getRouteWithSubMenu(route, permissions);\n        if (\n            (permissions && permissions.indexOf(route.permission) !== -1) ||\n            route.permission === \"\" ||\n            permissionsRoute.newRoute?.length\n        ) {\n            filterRoutes.push(permissionsRoute);\n        }\n    });\n    return filterRoutes;\n};\n\nconst mapStateToProps = (state) => {\n    const newPermissions = [];\n    const { permissions, settings, frontSetting, config, allConfigData } =\n        state;\n\n    if (permissions) {\n        permissions.forEach((permission) =>\n            newPermissions.push(permission.attributes.name)\n        );\n    }\n    return { newPermissions, settings, frontSetting, config, allConfigData };\n};\n\nexport default connect(mapStateToProps, { fetchConfig })(MasterLayout);\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,OAAO,KAAQ,aAAa,CACrC,MAAO,CAAAC,YAAY,KAAM,wBAAwB,CACjD,MAAO,CAAAC,MAAM,KAAM,iBAAiB,CACpC,MAAO,CAAAC,MAAM,KAAM,iBAAiB,CACpC,MAAO,CAAAC,mBAAmB,KAAM,+BAA+B,CAC/D,OAASC,MAAM,KAAQ,cAAc,CACrC,MAAO,CAAAC,WAAW,KAAM,uBAAuB,CAC/C,OAASC,WAAW,KAAQ,uBAAuB,CACnD,OAASC,eAAe,KAAQ,gCAAgC,CAChE,OAASC,MAAM,KAAQ,mCAAmC,CAC1D,OAASC,WAAW,KAAQ,8BAA8B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE3D,KAAM,CAAAC,YAAY,CAAIC,KAAK,EAAK,CAC5B,KAAM,CACFC,QAAQ,CACRC,cAAc,CACdC,YAAY,CACZT,WAAW,CACXU,MAAM,CACNC,aACJ,CAAC,CAAGL,KAAK,CACT,KAAM,CAACM,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxB,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAACyB,cAAc,CAAEC,iBAAiB,CAAC,CAAG1B,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAA2B,SAAS,CAAGN,MAAM,EAAIO,aAAa,CAACP,MAAM,CAAC,CACjD,KAAM,CAAAQ,KAAK,CAAGC,YAAY,CAACC,OAAO,CAACzB,MAAM,CAAC0B,KAAK,CAAC,CAEhDjC,SAAS,CAAC,IAAM,CACZ,GAAI8B,KAAK,CAAE,CACPlB,WAAW,CAAC,CAAC,CACjB,CACA,GAAI,CAACkB,KAAK,CAAE,CACRI,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG3B,WAAW,CAAC4B,GAAG,CAAG,GAAG,CAAG,QAAQ,CAC3D,CACJ,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,SAAS,CAAGA,CAAA,GAAM,CACpBb,mBAAmB,CAAC,CAACD,gBAAgB,CAAC,CAC1C,CAAC,CAED,KAAM,CAAAe,aAAa,CAAGA,CAAA,GAAM,CACxBZ,iBAAiB,CAAC,CAACD,cAAc,CAAC,CACtC,CAAC,CAED,mBACIV,KAAA,QAAKwB,SAAS,CAAC,mCAAmC,CAAArB,QAAA,eAC9CL,IAAA,CAACX,YAAY,EACTK,WAAW,CAAEoB,SAAU,CACvBP,YAAY,CAAEA,YAAa,CAC3BG,gBAAgB,CAAEA,gBAAiB,CACnCc,SAAS,CAAEA,SAAU,CACrBC,aAAa,CAAEA,aAAc,CAC7Bb,cAAc,CAAEA,cAAe,CAClC,CAAC,cACFV,KAAA,QACIwB,SAAS,CAAE,GACPd,cAAc,GAAK,IAAI,CAAG,aAAa,CAAG,SAAS,oCAClB,CAAAP,QAAA,eAErCL,IAAA,QAAK0B,SAAS,CAAC,2DAA2D,CAAArB,QAAA,cACtEH,KAAA,QAAKwB,SAAS,CAAC,oFAAoF,CAAArB,QAAA,eAC/FL,IAAA,WACI2B,IAAI,CAAC,QAAQ,CACbD,SAAS,CAAC,8CAA8C,CACxDE,KAAK,CAAC,iBAAiB,CACvBC,OAAO,CAAEL,SAAU,CAAAnB,QAAA,cAEnBL,IAAA,CAACJ,eAAe,EAACkC,IAAI,CAAEjC,MAAO,CAAC6B,SAAS,CAAC,MAAM,CAAE,CAAC,CAC9C,CAAC,cACT1B,IAAA,CAACR,mBAAmB,EAChBE,WAAW,CAAEA,WAAY,CACzBkB,cAAc,CAAEA,cAAe,CAClC,CAAC,cACFZ,IAAA,CAACV,MAAM,EAACwB,SAAS,CAAEA,SAAU,CAAE,CAAC,EAC/B,CAAC,CACL,CAAC,cACNd,IAAA,QAAK0B,SAAS,CAAC,mDAAmD,CAAArB,QAAA,cAC9DL,IAAA,QAAK0B,SAAS,CAAC,0BAA0B,CAAArB,QAAA,cACrCL,IAAA,QAAK0B,SAAS,CAAC,iBAAiB,CAAArB,QAAA,CAAEA,QAAQ,CAAM,CAAC,CAChD,CAAC,CACL,CAAC,cACNL,IAAA,QAAK0B,SAAS,CAAC,iBAAiB,CAAArB,QAAA,cAC5BL,IAAA,CAACT,MAAM,EACHkB,aAAa,CAAEA,aAAc,CAC7BF,YAAY,CAAEA,YAAa,CAC9B,CAAC,CACD,CAAC,EACL,CAAC,EACL,CAAC,CAEd,CAAC,CAED,KAAM,CAAAwB,mBAAmB,CAAGA,CAACC,KAAK,CAAEC,WAAW,GAAK,CAChD,KAAM,CAAAC,SAAS,CAAGF,KAAK,CAACG,OAAO,CACzBH,KAAK,CAACG,OAAO,CAACC,MAAM,CACfC,IAAI,EACDJ,WAAW,CAACK,OAAO,CAACD,IAAI,CAACE,UAAU,CAAC,GAAK,CAAC,CAAC,EAC3CF,IAAI,CAACE,UAAU,GAAK,EAC5B,CAAC,CACD,IAAI,CACV,KAAM,CAAAC,YAAY,CAAGN,SAAS,CAAG,CAAE,GAAGF,KAAK,CAAES,QAAQ,CAAEP,SAAU,CAAC,CAAGF,KAAK,CAC1E,MAAO,CAAAQ,YAAY,CACvB,CAAC,CAED,KAAM,CAAAzB,aAAa,CAAIP,MAAM,EAAK,CAC9B,KAAM,CAAAyB,WAAW,CAAGzB,MAAM,CAC1B,GAAI,CAAAkC,YAAY,CAAG,EAAE,CACrBhD,WAAW,CAACiD,OAAO,CAAEX,KAAK,EAAK,KAAAY,qBAAA,CAC3B,KAAM,CAAAC,gBAAgB,CAAGd,mBAAmB,CAACC,KAAK,CAAEC,WAAW,CAAC,CAChE,GACKA,WAAW,EAAIA,WAAW,CAACK,OAAO,CAACN,KAAK,CAACO,UAAU,CAAC,GAAK,CAAC,CAAC,EAC5DP,KAAK,CAACO,UAAU,GAAK,EAAE,GAAAK,qBAAA,CACvBC,gBAAgB,CAACJ,QAAQ,UAAAG,qBAAA,WAAzBA,qBAAA,CAA2BE,MAAM,CACnC,CACEJ,YAAY,CAACK,IAAI,CAACF,gBAAgB,CAAC,CACvC,CACJ,CAAC,CAAC,CACF,MAAO,CAAAH,YAAY,CACvB,CAAC,CAED,KAAM,CAAAM,eAAe,CAAIC,KAAK,EAAK,CAC/B,KAAM,CAAA3C,cAAc,CAAG,EAAE,CACzB,KAAM,CAAE2B,WAAW,CAAEiB,QAAQ,CAAE3C,YAAY,CAAEC,MAAM,CAAEC,aAAc,CAAC,CAChEwC,KAAK,CAET,GAAIhB,WAAW,CAAE,CACbA,WAAW,CAACU,OAAO,CAAEJ,UAAU,EAC3BjC,cAAc,CAACyC,IAAI,CAACR,UAAU,CAACY,UAAU,CAACC,IAAI,CAClD,CAAC,CACL,CACA,MAAO,CAAE9C,cAAc,CAAE4C,QAAQ,CAAE3C,YAAY,CAAEC,MAAM,CAAEC,aAAc,CAAC,CAC5E,CAAC,CAED,cAAe,CAAArB,OAAO,CAAC4D,eAAe,CAAE,CAAElD,WAAY,CAAC,CAAC,CAACK,YAAY,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}