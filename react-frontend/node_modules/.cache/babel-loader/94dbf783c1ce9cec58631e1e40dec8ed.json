{"ast":null,"code":"import React,{useState}from'react';import{connect,useDispatch}from'react-redux';import{ReactSearchAutocomplete}from'react-search-autocomplete';import{addToast}from'../../../../store/action/toastAction';import{toastType}from'../../../../constants';import{searchPurchaseProduct}from'../../../../store/action/purchaseProductAction';import{getFormattedMessage,placeholderText}from'../../../sharedMethod';import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faSearch}from\"@fortawesome/free-solid-svg-icons\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const ProductSearch=props=>{const{values,products,updateProducts,setUpdateProducts,customProducts,searchPurchaseProduct,handleValidation,isAllProducts}=props;const[searchString,setSearchString]=useState(\"\");const dispatch=useDispatch();const filterProducts=isAllProducts&&values.warehouse_id?products.map(item=>({name:item.attributes.name,code:item.attributes.code,id:item.id})):values.warehouse_id&&products.filter(qty=>qty&&qty.attributes&&qty.attributes.stock&&qty.attributes.stock.quantity>0).map(item=>({name:item.attributes.name,code:item.attributes.code,id:item.id}));const onProductSearch=code=>{if(!values.warehouse_id){handleValidation();}else{setSearchString(code);const newId=products.filter(item=>item.attributes.code===code||item.attributes.code===code.code).map(item=>item.id);const finalIdArrays=customProducts.map(id=>id.product_id);const finalId=finalIdArrays.filter(finalIdArray=>finalIdArray===newId[0]);if(finalId[0]!==undefined){if(updateProducts.find(exitId=>exitId.product_id===finalId[0])){dispatch(addToast({text:getFormattedMessage('globally.product-already-added.validate.message'),type:toastType.ERROR}));}else{searchPurchaseProduct(newId[0]);const pushArray=[...customProducts];if(updateProducts.filter(product=>product.code===code||product.code===code.code).length>0){setUpdateProducts(updateProducts=>updateProducts.map(item=>{return item;}));}else{const newProduct=pushArray.find(element=>element.product_id===finalId[0]);setUpdateProducts([...updateProducts,newProduct]);}}removeSearchClass();setSearchString(\"\");}}};const handleOnSearch=string=>{onProductSearch(string);};const handleOnSelect=result=>{onProductSearch(result);};const formatResult=item=>{return/*#__PURE__*/_jsxs(\"span\",{onClick:e=>e.stopPropagation(),children:[item.code,\" (\",item.name,\")\"]});};const removeSearchClass=()=>{const html=document.getElementsByClassName(`custom-search`)[0].firstChild.firstChild.lastChild;html.style.display='none';};return/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative custom-search\",children:[/*#__PURE__*/_jsx(ReactSearchAutocomplete,{items:filterProducts,onSearch:handleOnSearch,inputSearchString:searchString,fuseOptions:{keys:['code','name']},resultStringKeyName:\"code\",placeholder:placeholderText('globally.search.field.label'),onSelect:handleOnSelect,formatResult:formatResult,showIcon:false,showClear:false}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSearch,className:\"d-flex align-items-center top-0 bottom-0 react-search-icon my-auto text-gray-600 position-absolute\"})]});};export default connect(null,{searchPurchaseProduct})(ProductSearch);","map":{"version":3,"names":["React","useState","connect","useDispatch","ReactSearchAutocomplete","addToast","toastType","searchPurchaseProduct","getFormattedMessage","placeholderText","FontAwesomeIcon","faSearch","jsxs","_jsxs","jsx","_jsx","ProductSearch","props","values","products","updateProducts","setUpdateProducts","customProducts","handleValidation","isAllProducts","searchString","setSearchString","dispatch","filterProducts","warehouse_id","map","item","name","attributes","code","id","filter","qty","stock","quantity","onProductSearch","newId","finalIdArrays","product_id","finalId","finalIdArray","undefined","find","exitId","text","type","ERROR","pushArray","product","length","newProduct","element","removeSearchClass","handleOnSearch","string","handleOnSelect","result","formatResult","onClick","e","stopPropagation","children","html","document","getElementsByClassName","firstChild","lastChild","style","display","className","items","onSearch","inputSearchString","fuseOptions","keys","resultStringKeyName","placeholder","onSelect","showIcon","showClear","icon"],"sources":["C:/Users/Sithu/Music/react-frontend/src/shared/components/product-cart/search/ProductSearch.js"],"sourcesContent":["import React, {useState} from 'react';\nimport {connect, useDispatch} from 'react-redux';\nimport {ReactSearchAutocomplete} from 'react-search-autocomplete';\nimport {addToast} from '../../../../store/action/toastAction';\nimport {toastType} from '../../../../constants';\nimport {searchPurchaseProduct} from '../../../../store/action/purchaseProductAction';\nimport {getFormattedMessage, placeholderText} from '../../../sharedMethod';\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faSearch} from \"@fortawesome/free-solid-svg-icons\";\n\nconst ProductSearch = (props) => {\n    const {\n        values,\n        products,\n        updateProducts,\n        setUpdateProducts,\n        customProducts,\n        searchPurchaseProduct,\n        handleValidation,\n        isAllProducts\n    } = props;\n    const [searchString, setSearchString] = useState(\"\");\n    const dispatch = useDispatch();\n    const filterProducts = isAllProducts && values.warehouse_id ? products.map((item) => ({\n        name: item.attributes.name, code: item.attributes.code, id: item.id\n    })) : values.warehouse_id && products.filter((qty) => qty && qty.attributes && qty.attributes.stock && qty.attributes.stock.quantity > 0).map((item) => ({\n        name: item.attributes.name, code: item.attributes.code, id: item.id\n    }))\n\n    const onProductSearch = (code) => {\n        if (!values.warehouse_id) {\n            handleValidation();\n        } else {\n            setSearchString(code);\n            const newId = products.filter((item) => item.attributes.code === code || item.attributes.code === code.code).map((item) => item.id);\n            const finalIdArrays = customProducts.map((id) => id.product_id);\n            const finalId = finalIdArrays.filter((finalIdArray) => finalIdArray === newId[0]);\n            if (finalId[0] !== undefined) {\n                if (updateProducts.find(exitId => exitId.product_id === finalId[0])) {\n                    dispatch(addToast({\n                        text: getFormattedMessage('globally.product-already-added.validate.message'),\n                        type: toastType.ERROR\n                    }));\n                } else {\n                    searchPurchaseProduct(newId[0])\n                    const pushArray = [...customProducts]\n                    if (updateProducts.filter(product => product.code === code || product.code === code.code).length > 0) {\n                        setUpdateProducts(updateProducts => updateProducts.map((item) => {\n                            return item\n                        }))\n                    } else {\n                        const newProduct = pushArray.find(element => element.product_id === finalId[0]);\n                        setUpdateProducts([...updateProducts, newProduct]);\n                    }\n                }\n                removeSearchClass();\n                setSearchString(\"\");\n            }\n        }\n    }\n\n    const handleOnSearch = (string) => {\n        onProductSearch(string);\n    }\n\n    const handleOnSelect = (result) => {\n        onProductSearch(result);\n    }\n\n    const formatResult = (item) => {\n        return (\n            <span onClick={(e) => e.stopPropagation()}>{item.code} ({item.name})</span>\n        )\n    }\n\n    const removeSearchClass = () => {\n        const html = document.getElementsByClassName(`custom-search`)[0].firstChild.firstChild.lastChild;\n        html.style.display = 'none'\n    }\n\n    return (\n        <div className='position-relative custom-search'>\n            <ReactSearchAutocomplete\n                items={filterProducts}\n                onSearch={handleOnSearch}\n                inputSearchString={searchString}\n                fuseOptions={{keys: ['code', 'name']}}\n                resultStringKeyName='code'\n                placeholder={placeholderText('globally.search.field.label')}\n                onSelect={handleOnSelect}\n                formatResult={formatResult}\n                showIcon={false}\n                showClear={false}\n            />\n            <FontAwesomeIcon icon={faSearch}\n                             className='d-flex align-items-center top-0 bottom-0 react-search-icon my-auto text-gray-600 position-absolute'/>\n        </div>\n    );\n}\n\nexport default connect(null, {searchPurchaseProduct})(ProductSearch);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}