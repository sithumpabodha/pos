{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import moment from\"moment/moment\";import{connect}from\"react-redux\";import ReactDataTable from\"../../../../shared/table/ReactDataTable\";import{currencySymbolHandling,getFormattedMessage}from\"../../../../shared/sharedMethod\";import{stockDetailsPurchaseAction}from\"../../../../store/action/stockDetilsPurchaseAction\";import{fetchFrontSetting}from\"../../../../store/action/frontSettingAction\";import{stockDetailsPurchaseExcel}from\"../../../../store/action/stockDetailsPurchaseExcel\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const PurchaseTab=props=>{const{totalRecord,isLoading,stockDetailsPurchaseAction,frontSetting,fetchFrontSetting,warehouseValue,stockDetailsPurchaseExcel,stockDetailsPurchase,id,allConfigData}=props;const currencySymbol=frontSetting&&frontSetting.value&&frontSetting.value.currency_symbol;const[isWarehouseValue,setIsWarehouseValue]=useState(false);useEffect(()=>{if(isWarehouseValue===true){stockDetailsPurchaseExcel(id,setIsWarehouseValue);}},[isWarehouseValue]);useEffect(()=>{fetchFrontSetting();},[warehouseValue]);const itemsValue=currencySymbol&&stockDetailsPurchase.length>=0&&stockDetailsPurchase.map(sale=>({time:moment(sale.attributes.created_at).format(\"LT\"),date:moment(sale.attributes.date).format(\"YYYY-MM-DD\"),reference_code:sale.attributes.reference_code,supplier_name:sale.attributes.supplier_name,warehouse_name:sale.attributes.warehouse_name,id:sale.id,purchase_items:sale.attributes.purchase_items.map(item=>({name:item.product&&item.product.name,sub_total:item.sub_total,quantity:item.quantity,product_id:item.product_id})),currency:currencySymbol}));const columns=[{name:getFormattedMessage(\"globally.react-table.column.created-date.label\"),selector:row=>row.date,sortField:\"date\",sortable:true,cell:row=>{return/*#__PURE__*/_jsxs(\"span\",{className:\"badge bg-light-primary\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-1\",children:row.time}),/*#__PURE__*/_jsx(\"div\",{children:row.date})]});}},{name:getFormattedMessage(\"dashboard.recentSales.reference.label\"),sortField:\"reference_code\",sortable:false,cell:row=>{return/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-light-danger\",children:/*#__PURE__*/_jsx(\"span\",{children:row.reference_code})});}},{name:getFormattedMessage(\"supplier.table.name.column.title\"),sortField:\"name\",sortable:false,cell:row=>{return row.purchase_items.map(item=>item.product_id===Number(id)?item.name:\"\");}},{name:getFormattedMessage(\"purchase.select.supplier.label\"),selector:row=>row.supplier_name,sortField:\"supplier_name\",sortable:false},{name:getFormattedMessage(\"warehouse.title\"),selector:row=>row.warehouse_name,sortField:\"warehouse_name\",sortable:false},{name:getFormattedMessage(\"globally.detail.quantity\"),sortField:\"quantity\",sortable:false,cell:row=>{return row.purchase_items.map(item=>item.product_id===Number(id)?/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-light-danger\",children:/*#__PURE__*/_jsx(\"span\",{children:item.quantity})}):\"\");}},{name:getFormattedMessage(\"globally.detail.subtotal\"),sortField:\"sub_total\",sortable:false,cell:row=>{return row.purchase_items.map(item=>item.product_id===Number(id)?currencySymbolHandling(allConfigData,row.currency,item.sub_total):\"\");}}];const onChange=filter=>{stockDetailsPurchaseAction(id,filter,true);};const onExcelClick=()=>{setIsWarehouseValue(true);};return/*#__PURE__*/_jsx(ReactDataTable,{columns:columns,items:itemsValue,onChange:onChange,warehouseValue:warehouseValue,isLoading:isLoading,totalRows:totalRecord,isEXCEL:true,onExcelClick:onExcelClick});};const mapStateToProps=state=>{const{isLoading,totalRecord,stockDetailsPurchase,frontSetting}=state;return{isLoading,totalRecord,stockDetailsPurchase,frontSetting};};export default connect(mapStateToProps,{fetchFrontSetting,stockDetailsPurchaseAction,stockDetailsPurchaseExcel})(PurchaseTab);","map":{"version":3,"names":["React","useEffect","useState","moment","connect","ReactDataTable","currencySymbolHandling","getFormattedMessage","stockDetailsPurchaseAction","fetchFrontSetting","stockDetailsPurchaseExcel","jsx","_jsx","jsxs","_jsxs","PurchaseTab","props","totalRecord","isLoading","frontSetting","warehouseValue","stockDetailsPurchase","id","allConfigData","currencySymbol","value","currency_symbol","isWarehouseValue","setIsWarehouseValue","itemsValue","length","map","sale","time","attributes","created_at","format","date","reference_code","supplier_name","warehouse_name","purchase_items","item","name","product","sub_total","quantity","product_id","currency","columns","selector","row","sortField","sortable","cell","className","children","Number","onChange","filter","onExcelClick","items","totalRows","isEXCEL","mapStateToProps","state"],"sources":["C:/Users/Sithu/Music/react-frontend/src/components/report/stockReport/stockDetails/PurchaseTabs.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport moment from \"moment/moment\";\nimport { connect } from \"react-redux\";\nimport ReactDataTable from \"../../../../shared/table/ReactDataTable\";\nimport {\n    currencySymbolHandling,\n    getFormattedMessage,\n} from \"../../../../shared/sharedMethod\";\nimport { stockDetailsPurchaseAction } from \"../../../../store/action/stockDetilsPurchaseAction\";\nimport { fetchFrontSetting } from \"../../../../store/action/frontSettingAction\";\nimport { stockDetailsPurchaseExcel } from \"../../../../store/action/stockDetailsPurchaseExcel\";\n\nconst PurchaseTab = (props) => {\n    const {\n        totalRecord,\n        isLoading,\n        stockDetailsPurchaseAction,\n        frontSetting,\n        fetchFrontSetting,\n        warehouseValue,\n        stockDetailsPurchaseExcel,\n        stockDetailsPurchase,\n        id,\n        allConfigData,\n    } = props;\n    const currencySymbol =\n        frontSetting &&\n        frontSetting.value &&\n        frontSetting.value.currency_symbol;\n    const [isWarehouseValue, setIsWarehouseValue] = useState(false);\n\n    useEffect(() => {\n        if (isWarehouseValue === true) {\n            stockDetailsPurchaseExcel(id, setIsWarehouseValue);\n        }\n    }, [isWarehouseValue]);\n\n    useEffect(() => {\n        fetchFrontSetting();\n    }, [warehouseValue]);\n\n    const itemsValue =\n        currencySymbol &&\n        stockDetailsPurchase.length >= 0 &&\n        stockDetailsPurchase.map((sale) => ({\n            time: moment(sale.attributes.created_at).format(\"LT\"),\n            date: moment(sale.attributes.date).format(\"YYYY-MM-DD\"),\n            reference_code: sale.attributes.reference_code,\n            supplier_name: sale.attributes.supplier_name,\n            warehouse_name: sale.attributes.warehouse_name,\n            id: sale.id,\n            purchase_items: sale.attributes.purchase_items.map((item) => ({\n                name: item.product && item.product.name,\n                sub_total: item.sub_total,\n                quantity: item.quantity,\n                product_id: item.product_id,\n            })),\n            currency: currencySymbol,\n        }));\n\n    const columns = [\n        {\n            name: getFormattedMessage(\n                \"globally.react-table.column.created-date.label\"\n            ),\n            selector: (row) => row.date,\n            sortField: \"date\",\n            sortable: true,\n            cell: (row) => {\n                return (\n                    <span className=\"badge bg-light-primary\">\n                        <div className=\"mb-1\">{row.time}</div>\n                        <div>{row.date}</div>\n                    </span>\n                );\n            },\n        },\n        {\n            name: getFormattedMessage(\"dashboard.recentSales.reference.label\"),\n            sortField: \"reference_code\",\n            sortable: false,\n            cell: (row) => {\n                return (\n                    <span className=\"badge bg-light-danger\">\n                        <span>{row.reference_code}</span>\n                    </span>\n                );\n            },\n        },\n        {\n            name: getFormattedMessage(\"supplier.table.name.column.title\"),\n            sortField: \"name\",\n            sortable: false,\n            cell: (row) => {\n                return row.purchase_items.map((item) =>\n                    item.product_id === Number(id) ? item.name : \"\"\n                );\n            },\n        },\n        {\n            name: getFormattedMessage(\"purchase.select.supplier.label\"),\n            selector: (row) => row.supplier_name,\n            sortField: \"supplier_name\",\n            sortable: false,\n        },\n        {\n            name: getFormattedMessage(\"warehouse.title\"),\n            selector: (row) => row.warehouse_name,\n            sortField: \"warehouse_name\",\n            sortable: false,\n        },\n        {\n            name: getFormattedMessage(\"globally.detail.quantity\"),\n            sortField: \"quantity\",\n            sortable: false,\n            cell: (row) => {\n                return row.purchase_items.map((item) =>\n                    item.product_id === Number(id) ? (\n                        <span className=\"badge bg-light-danger\">\n                            <span>{item.quantity}</span>\n                        </span>\n                    ) : (\n                        \"\"\n                    )\n                );\n            },\n        },\n        {\n            name: getFormattedMessage(\"globally.detail.subtotal\"),\n            sortField: \"sub_total\",\n            sortable: false,\n            cell: (row) => {\n                return row.purchase_items.map((item) =>\n                    item.product_id === Number(id)\n                        ? currencySymbolHandling(\n                              allConfigData,\n                              row.currency,\n                              item.sub_total\n                          )\n                        : \"\"\n                );\n            },\n        },\n    ];\n\n    const onChange = (filter) => {\n        stockDetailsPurchaseAction(id, filter, true);\n    };\n\n    const onExcelClick = () => {\n        setIsWarehouseValue(true);\n    };\n\n    return (\n        <ReactDataTable\n            columns={columns}\n            items={itemsValue}\n            onChange={onChange}\n            warehouseValue={warehouseValue}\n            isLoading={isLoading}\n            totalRows={totalRecord}\n            isEXCEL\n            onExcelClick={onExcelClick}\n        />\n    );\n};\n\nconst mapStateToProps = (state) => {\n    const { isLoading, totalRecord, stockDetailsPurchase, frontSetting } =\n        state;\n    return { isLoading, totalRecord, stockDetailsPurchase, frontSetting };\n};\n\nexport default connect(mapStateToProps, {\n    fetchFrontSetting,\n    stockDetailsPurchaseAction,\n    stockDetailsPurchaseExcel,\n})(PurchaseTab);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}